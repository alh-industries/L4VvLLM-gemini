#!/bin/bash
# ===================================================================================
#
# DANGER: THIS SCRIPT DELETES ALL OPEN AND CLOSED ISSUES IN THE REPOSITORY.
#
# Use this script to "purge" the repo before performing a fresh import.
# It must be run manually from your local machine.
# 
# v0 - init
# ===================================================================================

echo "WARNING: This will permanently delete ALL issues from the repository."
read -p "Are you sure you want to continue? (y/n) " -n 1 -r
echo    # move to a new line
if [[ !$REPLY =~ ^[Yy]$ ]]
then
    echo "Aborted."
    exit 1
fi

echo "Fetching all issues to delete..."

# Get all issue numbers, then pipe them to the delete command.
gh issue list --state all --limit 9999 --json number -q '.[].number' | xargs -n 1 -I {} gh issue delete {} --yes

echo "All issues have been purged."
